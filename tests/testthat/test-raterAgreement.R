# ==== Ensure results are unchanged on JASP debug data ====

####Cohen's unweighted kappa and Fleiss' kappa and Krippendorff's alpha####

# Set options
options <- analysisOptions("raterAgreement")
options$variables <- c("V1", "facFifty", "contNormal")
options$krippendorffsAlphaDataStructure <- "ratersInColumns"
set.seed(1)
results <- runAnalysis("raterAgreement", "test.csv", options)


test_that("Cohen's Unweighted kappa table results match", {
  table <- results[["results"]][["cohensKappa"]][["data"]]
  jaspTools::expect_equal_tables(table,
                                 list("", "", "", 0.164983164983165, "Average kappa", 0.396961294518455,
                                      0.592937695380535, 0.049994898479747, 0.494949494949495, "V1 - facFifty",
                                      0, 0, 0, 0, "V1 - contNormal", 0, 0, 0, 0, "facFifty - contNormal"
                                 ))
})

test_that("Fleiss' kappa table results match", {
  table <- results[["results"]][["fleissKappa"]][["data"]]
  jaspTools::expect_equal_tables(table,
                                 list(0.151819081246537, 0.170328569760174, 0.00472189506022491, 0.161073825503356,
                                      "Overall", -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, -3.023963827, -0.116158573407617, 0.110158573407617,
                                      0.0577350269189626, -0.003, -2.336742886, -0.116158573407617,
                                      0.110158573407617, 0.0577350269189626, -0.003, -2.15616121,
                                      -0.116158573407617, 0.110158573407617, 0.0577350269189626, -0.003,
                                      -1.953344972, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, -1.649937891, -0.116158573407617, 0.110158573407617,
                                      0.0577350269189626, -0.003, -1.627592736, -0.116158573407617,
                                      0.110158573407617, 0.0577350269189626, -0.003, -1.625143884,
                                      -0.116158573407617, 0.110158573407617, 0.0577350269189626, -0.003,
                                      -1.447375559, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, -1.415363942, -0.116158573407617, 0.110158573407617,
                                      0.0577350269189626, -0.003, -1.395443011, -0.116158573407617,
                                      0.110158573407617, 0.0577350269189626, -0.003, -1.375547175,
                                      -0.116158573407617, 0.110158573407617, 0.0577350269189626, -0.003,
                                      -1.363597632, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, -1.352650303, -0.116158573407617, 0.110158573407617,
                                      0.0577350269189626, -0.003, -1.264009159, -0.116158573407617,
                                      0.110158573407617, 0.0577350269189626, -0.003, -1.144123942,
                                      -0.116158573407617, 0.110158573407617, 0.0577350269189626, -0.003,
                                      -1.030775205, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, -0.999014305, -0.116158573407617, 0.110158573407617,
                                      0.0577350269189626, -0.003, -0.954597608, -0.116158573407617,
                                      0.110158573407617, 0.0577350269189626, -0.003, -0.937671609,
                                      -0.116158573407617, 0.110158573407617, 0.0577350269189626, -0.003,
                                      -0.934349142, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, -0.881899561, -0.116158573407617, 0.110158573407617,
                                      0.0577350269189626, -0.003, -0.850244619, -0.116158573407617,
                                      0.110158573407617, 0.0577350269189626, -0.003, -0.840984252,
                                      -0.116158573407617, 0.110158573407617, 0.0577350269189626, -0.003,
                                      -0.805996397, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, -0.805832374, -0.116158573407617, 0.110158573407617,
                                      0.0577350269189626, -0.003, -0.801894546, -0.116158573407617,
                                      0.110158573407617, 0.0577350269189626, -0.003, -0.786160472,
                                      -0.116158573407617, 0.110158573407617, 0.0577350269189626, -0.003,
                                      -0.751445953, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, -0.712944476, -0.116158573407617, 0.110158573407617,
                                      0.0577350269189626, -0.003, -0.707972381, -0.116158573407617,
                                      0.110158573407617, 0.0577350269189626, -0.003, -0.692689912,
                                      -0.116158573407617, 0.110158573407617, 0.0577350269189626, -0.003,
                                      -0.675270732, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, -0.667823773, -0.116158573407617, 0.110158573407617,
                                      0.0577350269189626, -0.003, -0.658287055, -0.116158573407617,
                                      0.110158573407617, 0.0577350269189626, -0.003, -0.656919662,
                                      -0.116158573407617, 0.110158573407617, 0.0577350269189626, -0.003,
                                      -0.654979378, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, -0.648908102, -0.116158573407617, 0.110158573407617,
                                      0.0577350269189626, -0.003, -0.632883125, -0.116158573407617,
                                      0.110158573407617, 0.0577350269189626, -0.003, -0.618288772,
                                      -0.116158573407617, 0.110158573407617, 0.0577350269189626, -0.003,
                                      -0.611664173, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, -0.59740969, -0.116158573407617, 0.110158573407617,
                                      0.0577350269189626, -0.003, -0.556843301, -0.116158573407617,
                                      0.110158573407617, 0.0577350269189626, -0.003, -0.532552496,
                                      -0.116158573407617, 0.110158573407617, 0.0577350269189626, -0.003,
                                      -0.470163224, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, -0.443990603, -0.116158573407617, 0.110158573407617,
                                      0.0577350269189626, -0.003, -0.434493855, -0.116158573407617,
                                      0.110158573407617, 0.0577350269189626, -0.003, -0.433036966,
                                      -0.116158573407617, 0.110158573407617, 0.0577350269189626, -0.003,
                                      -0.412828649, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, -0.399043745, -0.116158573407617, 0.110158573407617,
                                      0.0577350269189626, -0.003, -0.398710373, -0.116158573407617,
                                      0.110158573407617, 0.0577350269189626, -0.003, -0.367996707,
                                      -0.116158573407617, 0.110158573407617, 0.0577350269189626, -0.003,
                                      -0.359553637, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, -0.342746069, -0.116158573407617, 0.110158573407617,
                                      0.0577350269189626, -0.003, -0.242813433, -0.116158573407617,
                                      0.110158573407617, 0.0577350269189626, -0.003, -0.199426499,
                                      -0.116158573407617, 0.110158573407617, 0.0577350269189626, -0.003,
                                      -0.120997408, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, -0.118805371, -0.116158573407617, 0.110158573407617,
                                      0.0577350269189626, -0.003, -0.096001487, -0.116158573407617,
                                      0.110158573407617, 0.0577350269189626, -0.003, -0.0767995, -0.116158573407617,
                                      0.110158573407617, 0.0577350269189626, -0.003, -0.051036508,
                                      -0.116158573407617, 0.110158573407617, 0.0577350269189626, -0.003,
                                      0.01096381, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 0.092206944, -0.116158573407617, 0.110158573407617,
                                      0.0577350269189626, -0.003, 0.108920494, -0.116158573407617,
                                      0.110158573407617, 0.0577350269189626, -0.003, 0.166778121,
                                      -0.116158573407617, 0.110158573407617, 0.0577350269189626, -0.003,
                                      0.176474657, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 0.239571257, -0.116158573407617, 0.110158573407617,
                                      0.0577350269189626, -0.003, 0.259356367, -0.116158573407617,
                                      0.110158573407617, 0.0577350269189626, -0.003, 0.260454418,
                                      -0.116158573407617, 0.110158573407617, 0.0577350269189626, -0.003,
                                      0.284253602, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 0.307537423, -0.116158573407617, 0.110158573407617,
                                      0.0577350269189626, -0.003, 0.310181524, -0.116158573407617,
                                      0.110158573407617, 0.0577350269189626, -0.003, 0.337436519,
                                      -0.116158573407617, 0.110158573407617, 0.0577350269189626, -0.003,
                                      0.364848251, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 0.376149862, -0.116158573407617, 0.110158573407617,
                                      0.0577350269189626, -0.003, 0.391750556, -0.116158573407617,
                                      0.110158573407617, 0.0577350269189626, -0.003, 0.441266475,
                                      -0.116158573407617, 0.110158573407617, 0.0577350269189626, -0.003,
                                      0.46937728, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 0.503236412, -0.116158573407617, 0.110158573407617,
                                      0.0577350269189626, -0.003, 0.505173357, -0.116158573407617,
                                      0.110158573407617, 0.0577350269189626, -0.003, 0.518141224,
                                      -0.116158573407617, 0.110158573407617, 0.0577350269189626, -0.003,
                                      0.525950287, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 0.544538215, -0.116158573407617, 0.110158573407617,
                                      0.0577350269189626, -0.003, 0.570675169, -0.116158573407617,
                                      0.110158573407617, 0.0577350269189626, -0.003, 0.588682079,
                                      -0.116158573407617, 0.110158573407617, 0.0577350269189626, -0.003,
                                      0.596201293, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 0.644058891, -0.116158573407617, 0.110158573407617,
                                      0.0577350269189626, -0.003, 0.757371551, -0.116158573407617,
                                      0.110158573407617, 0.0577350269189626, -0.003, 0.793185108,
                                      -0.116158573407617, 0.110158573407617, 0.0577350269189626, -0.003,
                                      0.947933415, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 0.972104397, -0.116158573407617, 0.110158573407617,
                                      0.0577350269189626, -0.003, 0.99122228, 0.213841426592383, 0.440158573407617,
                                      0.0577350269189626, 0.327, 1, -0.116158573407617, 0.110158573407617,
                                      0.0577350269189626, -0.003, 1.007309698, -0.116158573407617,
                                      0.110158573407617, 0.0577350269189626, -0.003, 1.058565048,
                                      -0.116158573407617, 0.110158573407617, 0.0577350269189626, -0.003,
                                      1.410001008, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 1.576301642, -0.116158573407617, 0.110158573407617,
                                      0.0577350269189626, -0.003, 1.889051803, 0.213841426592383,
                                      0.440158573407617, 0.0577350269189626, 0.327, 2, -0.116158573407617,
                                      0.110158573407617, 0.0577350269189626, -0.003, 2.179421126,
                                      -0.116158573407617, 0.110158573407617, 0.0577350269189626, -0.003,
                                      2.739343353, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 2.958797116, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 3, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 3.356094448, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 4, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 5, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 6, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 7, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 8, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 9, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 10, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 11, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 12, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 13, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 14, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 15, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 16, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 17, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 18, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 19, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 20, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 21, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 22, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 23, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 24, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 25, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 26, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 27, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 28, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 29, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 30, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 31, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 32, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 33, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 34, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 35, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 36, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 37, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 38, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 39, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 40, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 41, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 42, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 43, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 44, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 45, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 46, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 47, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 48, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 49, 0.213841426592383, 0.440158573407617, 0.0577350269189626,
                                      0.327, 50, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 51, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 52, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 53, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 54, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 55, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 56, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 57, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 58, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 59, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 60, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 61, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 62, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 63, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 64, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 65, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 66, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 67, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 68, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 69, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 70, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 71, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 72, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 73, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 74, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 75, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 76, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 77, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 78, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 79, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 80, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 81, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 82, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 83, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 84, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 85, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 86, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 87, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 88, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 89, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 90, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 91, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 92, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 93, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 94, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 95, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 96, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 97, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 98, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 99, -0.116158573407617, 0.110158573407617, 0.0577350269189626,
                                      -0.003, 100))
})


test_that("Krippendorff's alpha table results match", {
  table <- results[["results"]][["krippendorffsAlpha"]][["data"]]
  jaspTools::expect_equal_tables(table,
                                 list(0.128688123975843, 0.192400836732261, 0.0164047879778507, 0.162472035794184,
                                      "Nominal"))
})

####Cohen's weighted kappa and Fleiss' kappa and Krippendorf's alpha with different CI range(99%)####

# Set options
options <- analysisOptions("raterAgreement")
options$variables <- c("facGender", "facExperim", "debBinMiss20")
options$ciLevel <- 0.99
options$cohensKappaType <- "weighted"
options$krippendorffsAlphaBootstrapSamplesForCI <- 200
options$krippendorffsAlphaDataStructure <- "ratersInColumns"
options$setSeed <- TRUE
set.seed(1)
results <- runAnalysis("raterAgreement", "test.csv", options)


test_that("Cohen's Weighted kappa table results match", {
  table <- results[["results"]][["cohensKappa"]][["data"]]
  jaspTools::expect_equal_tables(table,
                                 list("", "", "", -0.00184386638316336, "Average kappa", -0.0105967225936691,
                                      0.0461522781492244, 0.0110156757407617, 0.0177777777777777,
                                      "facGender - facExperim", -0.0393585273220366, 0.026999385191902,
                                      0.012880883143637, -0.00617957106506728, "facGender - debBinMiss20",
                                      -0.0516244390801057, 0.0173648273557048, 0.0133916611517617,
                                      -0.0171298058622005, "facExperim - debBinMiss20"))
})

test_that("Fleiss' kappa table results match", {
  table <- results[["results"]][["fleissKappa"]][["data"]]
  jaspTools::expect_equal_tables(table,
                                 list(-0.276327852798572, -0.127177258822542, 0.0289519561273983, -0.201752555810557,
                                      "Overall", -0.360269066588632, -0.0277309334113677, 0.0645497224367903,
                                      -0.194, "f", -0.372269066588632, -0.0397309334113677, 0.0645497224367903,
                                      -0.206, "m", -0.384269066588632, -0.0517309334113677, 0.0645497224367903,
                                      -0.218, "control", -0.348269066588632, -0.0157309334113677,
                                      0.0645497224367903, -0.182, "experimental", -0.337269066588632,
                                      -0.00473093341136771, 0.0645497224367903, -0.171, 0, -0.397269066588632,
                                      -0.0647309334113677, 0.0645497224367903, -0.231, 1))
})

test_that("Krippendorff's alpha table results match", {
  table <- results[["results"]][["krippendorffsAlpha"]][["data"]]
  jaspTools::expect_equal_tables(table,
                                 list(-0.212534930259255, -0.197193484221555, 0.00279613421372955, -0.199079048349962,
                                      "Nominal"))
})


# ==== Verify results of Fleiss' kappa with data set from Fleiss (1971) NOTE: Only verifying kappa values, not CIs====
test_that("Fleiss' kappa table results match", {
  options <- analysisOptions("raterAgreement")
  options$variables <- c("V1", "V2", "V3", "V4", "V5", "V6")
  options$cohensKappa <- FALSE
  options$ci <- FALSE
  set.seed(1)
  results <- runAnalysis("raterAgreement", "Fleiss1971.csv", options)
  table <- results[["results"]][["fleissKappa"]][["data"]]
  jaspTools::expect_equal_tables(table,
                                 list(0.430244520060141, "Overall", 0.245, 1, 0.245, 2, 0.52, 3, 0.471,
                                      4, 0.566, 5))
})


test_that("Cohen's kappa table results match with linear weighting", {
  options <- analysisOptions("raterAgreement")
  options$variables <- c("V1", "V2")
  options$fleissKappa <- FALSE
  options$krippendorffsAlpha <- FALSE
  options$ci <- FALSE
  options$cohensKappaType <- "weighted"
  options$weightType <- "linear"
  set.seed(1)
  results <- runAnalysis("raterAgreement", "Fleiss1971.csv", options)
  table <- results[["results"]][["cohensKappa"]][["data"]]
  jaspTools::expect_equal_tables(table,
                                 list(0.633093525179856, "Average kappa", 0.633093525179856, "V1 - V2"
                                 ))
})

